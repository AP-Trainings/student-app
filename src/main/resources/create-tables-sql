DROP SCHEMA IF EXISTS `SCHOOL_MANAGEMENT`;

CREATE SCHEMA `SCHOOL_MANAGEMENT`;

USE `SCHOOL_MANAGEMENT`;

DROP TABLE IF EXISTS `STUDENT_DETAIL`;

CREATE TABLE `STUDENT_DETAIL` (
	`DETAIL_ID` int not null AUTO_INCREMENT,
	`ADDRESS` varchar(300) default null,
	`FATHER_NAME` varchar(100) not null,
	`DATE_OF_BIRTH` varchar(10) not null,
	`CONTACT_NUMBER` int default null,
	PRIMARY KEY (`DETAIL_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=100 DEFAULT CHARSET = latin1;

DROP TABLE IF EXISTS `STUDENT`;

CREATE TABLE `STUDENT` (
	`STUDENT_ID` int not null AUTO_INCREMENT,
	`FIRST_NAME` varchar(50) not null,
	`LAST_NAME` varchar(50) not null,
	`STUDENT_DETAIL_ID` int not null,
	PRIMARY KEY (STUDENT_ID),
	
	-- Connect with STUDENT_DETAIL TABLE (ONE TO ONE MAPPING)
	KEY `STD_DETAIL_ID` (`STUDENT_DETAIL_ID`),
	CONSTRAINT `FK_STUDENT_DETAIL_CTST` FOREIGN KEY (`STUDENT_DETAIL_ID`) REFERENCES `STUDENT_DETAIL` (`DETAIL_ID`)
	ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET = latin1;

DROP TABLE IF EXISTS `CLASS`;

CREATE TABLE `CLASS` (
	`CLASS_ID` int not null AUTO_INCREMENT,
	`CLASS_NAME` varchar(15) not null,
	`TOTAL_STUDENTS` int not null,
	PRIMARY KEY (`CLASS_ID`),
	UNIQUE KEY `CLASS_NAME_UNIQUE` (`CLASS_NAME`)
) ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET = latin1;

DROP TABLE IF EXISTS `STUDENT_CLASS`;

CREATE TABLE `STUDENT_CLASS` (
	`STUDENT_ID` int not null,
	`CLASS_ID` int not null,
	PRIMARY KEY (`STUDENT_ID`, `CLASS_ID`),

	-- MANY - TO - MANY MAPPING
	KEY `CLASS` (`CLASS_ID`),
	CONSTRAINT `FK_STUDENT_SUBJECT_CTST1` FOREIGN KEY (`STUDENT_ID`) REFERENCES `STUDENT` (`STUDENT_ID`),
	CONSTRAINT `FK_STUDENT_SUBJECT_CTST2` FOREIGN KEY (`CLASS_ID`) REFERENCES `CLASS` (`CLASS_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=10000 DEFAULT CHARSET = latin1;

DROP TABLE IF EXISTS `STUDENT_MARK`;

CREATE TABLE `STUDENT_MARK` (
	`MARK_ID` INT NOT NULL AUTO_INCREMENT,
	`SUBJECT` varchar(30) not null,
	`MARKS` int not null,
	`ID_STUDENT` int not null,
	PRIMARY KEY (`MARK_ID`),
	
	-- check unique key
	UNIQUE KEY `MARK_SUBJECT_UNIQUE` (`SUBJECT`),
	
	-- ONE TO MANY MAPPING
	CONSTRAINT `FK_STUDENT_MARK_CTST` FOREIGN KEY (`ID_STUDENT`) REFERENCES `STUDENT` (`STUDENT_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=1000000 DEFAULT CHARSET = latin1;